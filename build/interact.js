// Generated by CoffeeScript 1.6.3
/*
                       __  .__              ________ 
   ______ ____   _____/  |_|__| ____   ____/   __   \
  /  ___// __ \_/ ___\   __\  |/  _ \ /    \____    /
  \___ \\  ___/\  \___|  | |  (  <_> )   |  \ /    / 
 /____  >\___  >\___  >__| |__|\____/|___|  //____/  .co.uk
      \/     \/     \/                    \/         
                                              CoffeeGL
                                              Benjamin Blundell - ben@section9.co.uk
                                              http://www.section9.co.uk
*/


(function() {
  var EquatorieInteract, EquatorieState,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; };

  EquatorieState = (function() {
    function EquatorieState(name, func, duration) {
      this.name = name;
      this.func = func;
      this.duration = duration != null ? duration : 3;
      if (this.duration == null) {
        this.duration = 3.0;
      }
    }

    EquatorieState.prototype.update = function(dt) {
      return this.func(dt);
    };

    EquatorieState.prototype.activate = function() {};

    return EquatorieState;

  })();

  EquatorieInteract = (function() {
    function EquatorieInteract(system, physics, camera, white_start, white_end, black_start, black_end, epicycle, pointer, marker, string_height) {
      this.system = system;
      this.physics = physics;
      this.camera = camera;
      this.white_start = white_start;
      this.white_end = white_end;
      this.black_start = black_start;
      this.black_end = black_end;
      this.epicycle = epicycle;
      this.pointer = pointer;
      this.marker = marker;
      this.string_height = string_height;
      this._stateMoveBlackStringLatitude = __bind(this._stateMoveBlackStringLatitude, this);
      this._stateMoveBlackStringFinal = __bind(this._stateMoveBlackStringFinal, this);
      this._stateRotateLabel = __bind(this._stateRotateLabel, this);
      this._stateRotateMeanAux = __bind(this._stateRotateMeanAux, this);
      this._stateRotateEpicycle = __bind(this._stateRotateEpicycle, this);
      this._stateMoveEpicycle = __bind(this._stateMoveEpicycle, this);
      this._stateMoveBlackThreadSun = __bind(this._stateMoveBlackThreadSun, this);
      this._stateMoveWhiteThreadSun = __bind(this._stateMoveWhiteThreadSun, this);
      this._stateMoveWhiteThreadMoon = __bind(this._stateMoveWhiteThreadMoon, this);
      this._stateMoveWhiteThread = __bind(this._stateMoveWhiteThread, this);
      this._stateMoveBlackThread = __bind(this._stateMoveBlackThread, this);
      this._stateCalculateMeanMotus = __bind(this._stateCalculateMeanMotus, this);
      this._stateSetPlanetDate = __bind(this._stateSetPlanetDate, this);
      this.mp = new CoffeeGL.Vec2(-1, -1);
      this.mpp = new CoffeeGL.Vec2(-1, -1);
      this.mpd = new CoffeeGL.Vec2(0, 0);
      this.picked = false;
      this.picked_item = void 0;
      this.dragging = false;
      this.advance_date = 0;
      this.stack = [];
      this.stack_idx = 0;
      this._initGUI();
      this.time = {
        start: 0,
        dt: 0
      };
    }

    EquatorieInteract.prototype.update = function(dt) {
      var da;
      if (this.stack.length > 0) {
        if (this.time.dt / 1000 > this.stack[this.stack_idx].duration) {
          this.stack[this.stack_idx].update(1.0);
          return;
        } else if (this.time.dt < 0) {
          this.stack[this.stack_idx].update(0.0);
          return;
        } else {
          da = (this.time.dt / 1000) / this.stack[this.stack_idx].duration;
          this.stack[this.stack_idx].update(da);
          this.time.dt += dt;
        }
      }
      return this.time.start = new Date().getTime();
    };

    EquatorieInteract.prototype._stateSetPlanetDate = function(planet, date) {
      this.system.solveForPlanetDate(planet, date);
      return this;
    };

    EquatorieInteract.prototype._stateCalculateMeanMotus = function(dt) {
      return this;
    };

    EquatorieInteract.prototype._stateMoveBlackThread = function(dt) {
      var current_state, mv;
      current_state = this.stack[this.stack_idx];
      if (current_state.end_interp == null) {
        mv = this.system.state.meanMotusPosition.copy();
        mv.normalize();
        mv.multScalar(10.0);
        current_state.end_interp = new CoffeeGL.Interpolation(this.black_end.matrix.getPos(), new CoffeeGL.Vec3(mv.x, this.string_height, mv.y));
      }
      if (current_state.start_interp == null) {
        current_state.start_interp = new CoffeeGL.Interpolation(this.black_start.matrix.getPos(), new CoffeeGL.Vec3(0, this.string_height, 0));
      }
      this.black_start.matrix.setPos(current_state.start_interp.set(dt));
      this.black_end.matrix.setPos(current_state.end_interp.set(dt));
      this.physics.postMessage({
        cmd: "black_start_move",
        data: this.black_start.matrix.getPos()
      });
      this.physics.postMessage({
        cmd: "black_end_move",
        data: this.black_end.matrix.getPos()
      });
      return this;
    };

    EquatorieInteract.prototype._stateMoveWhiteThread = function(dt) {
      var current_state, eq, pv;
      current_state = this.stack[this.stack_idx];
      if (current_state.end_interp == null) {
        eq = this.system.state.equantPosition;
        pv = this.system.state.parallelPosition;
        pv.sub(eq);
        pv.normalize();
        pv.multScalar(10.0);
        pv.add(eq);
        current_state.end_interp = new CoffeeGL.Interpolation(this.white_end.matrix.getPos(), new CoffeeGL.Vec3(pv.x, this.string_height, pv.y));
      }
      if (current_state.start_interp == null) {
        eq = this.system.state.equantPosition;
        current_state.start_interp = new CoffeeGL.Interpolation(this.white_start.matrix.getPos(), new CoffeeGL.Vec3(eq.x, this.string_height, eq.y));
      }
      this.white_start.matrix.setPos(current_state.start_interp.set(dt));
      this.white_end.matrix.setPos(current_state.end_interp.set(dt));
      this.physics.postMessage({
        cmd: "white_start_move",
        data: this.white_start.matrix.getPos()
      });
      return this.physics.postMessage({
        cmd: "white_end_move",
        data: this.white_end.matrix.getPos()
      });
    };

    EquatorieInteract.prototype._stateMoveWhiteThreadMoon = function(dt) {
      var current_state, eq, pv;
      current_state = this.stack[this.stack_idx];
      if (current_state.end_interp == null) {
        pv = this.system.state.pointerPoint.copy();
        pv.sub(this.system.state.equantPosition);
        pv.normalize();
        pv.multScalar(10.0);
        pv.add(this.system.state.equantPosition);
        pv = new CoffeeGL.Vec3(pv.x, this.string_height, pv.y);
        current_state.end_interp = new CoffeeGL.Interpolation(this.white_end.matrix.getPos(), pv);
      }
      if (current_state.start_interp == null) {
        eq = this.system.state.equantPosition;
        current_state.start_interp = new CoffeeGL.Interpolation(this.white_start.matrix.getPos(), new CoffeeGL.Vec3(eq.x, this.string_height, eq.y));
      }
      this.white_start.matrix.setPos(current_state.start_interp.set(dt));
      this.white_end.matrix.setPos(current_state.end_interp.set(dt));
      this.physics.postMessage({
        cmd: "white_start_move",
        data: this.white_start.matrix.getPos()
      });
      this.physics.postMessage({
        cmd: "white_end_move",
        data: this.white_end.matrix.getPos()
      });
      return this;
    };

    EquatorieInteract.prototype._stateMoveWhiteThreadSun = function(dt) {
      var current_state, ev, pv;
      current_state = this.stack[this.stack_idx];
      if (current_state.end_interp == null) {
        ev = new CoffeeGL.Vec3(this.system.state.equantPosition.x, this.string_height, this.system.state.equantPosition.y);
        current_state.end_interp = new CoffeeGL.Interpolation(this.white_end.matrix.getPos(), ev);
      }
      if (current_state.start_interp == null) {
        pv = this.system.state.parallelPosition.copy();
        pv.sub(this.system.state.equantPosition);
        pv.normalize();
        pv.multScalar(10.0);
        pv.add(this.system.state.equantPosition);
        pv = new CoffeeGL.Vec3(pv.x, this.string_height, pv.y);
        current_state.start_interp = new CoffeeGL.Interpolation(this.white_start.matrix.getPos(), pv);
      }
      this.white_start.matrix.setPos(current_state.start_interp.set(dt));
      this.white_end.matrix.setPos(current_state.end_interp.set(dt));
      this.physics.postMessage({
        cmd: "white_start_move",
        data: this.white_start.matrix.getPos()
      });
      this.physics.postMessage({
        cmd: "white_end_move",
        data: this.white_end.matrix.getPos()
      });
      return this;
    };

    EquatorieInteract.prototype._stateMoveBlackThreadSun = function(dt) {
      var current_state, pv;
      current_state = this.stack[this.stack_idx];
      if (current_state.end_interp == null) {
        pv = this.system.state.sunCirclePoint.copy();
        pv.normalize();
        pv.multScalar(10.0);
        pv = new CoffeeGL.Vec3(pv.x, this.string_height, pv.y);
        current_state.end_interp = new CoffeeGL.Interpolation(this.white_start.matrix.getPos(), pv);
      }
      this.black_end.matrix.setPos(current_state.end_interp.set(dt));
      this.physics.postMessage({
        cmd: "black_end_move",
        data: this.black_end.matrix.getPos()
      });
      return this;
    };

    EquatorieInteract.prototype._stateMoveEpicycle = function(dt) {
      var c, current_state, d, dr, e, v, _ref;
      current_state = this.stack[this.stack_idx];
      if (current_state.pos_interp == null) {
        d = this.system.state.deferentPosition;
        c = this.system.state.basePosition;
        v = this.system.state.parallelPosition;
        dr = this.system.state.deferentAngle;
        if (this.chosen_planet === "mercury") {
          dr = this.system.state.mercuryDeferentAngle;
        }
        e = this.system.state.epicyclePrePosition;
        current_state.pos_interp = new CoffeeGL.Interpolation(this.epicycle.matrix.getPos(), new CoffeeGL.Vec3(e.x, 0, e.y));
        current_state.rot_interp = new CoffeeGL.Interpolation(0, -90 - dr);
      }
      this.epicycle.matrix.identity();
      this.epicycle.matrix.translate(current_state.pos_interp.set(dt));
      this.epicycle.matrix.rotate(new CoffeeGL.Vec3(0, 1, 0), CoffeeGL.degToRad(current_state.rot_interp.set(dt)));
      this.marker.matrix.identity();
      if (this.chosen_planet === "mercury") {
        this.marker.matrix.translate(new CoffeeGL.Vec3(this.system.state.mercuryDeferentPosition.x, 0.0, this.system.state.mercuryDeferentPosition.y));
      } else if ((_ref = this.chosen_planet) === "mars" || _ref === "venus" || _ref === "jupiter" || _ref === "saturn" || _ref === "moon") {
        this.marker.matrix.translate(new CoffeeGL.Vec3(this.system.state.deferentPosition.x, 0.0, this.system.state.deferentPosition.y));
      }
      return this;
    };

    EquatorieInteract.prototype._stateRotateEpicycle = function(dt) {
      var cp, current_state, deferentAngle, fmatrix, tmatrix, v1, v2;
      current_state = this.stack[this.stack_idx];
      if (current_state.rot_interp == null) {
        current_state.rot_interp = new CoffeeGL.Interpolation(0, this.system.state.epicycleRotation);
      }
      v1 = this.system.state.deferentPosition;
      v2 = CoffeeGL.Vec2.sub(this.system.state.epicyclePrePosition, v1);
      tmatrix = new CoffeeGL.Matrix4();
      fmatrix = new CoffeeGL.Matrix4();
      deferentAngle = this.system.state.deferentAngle;
      if (this.chosen_planet === "mercury") {
        deferentAngle = this.system.state.mercuryDeferentAngle;
      }
      tmatrix.translate(new CoffeeGL.Vec3(v2.x, 0, v2.y));
      tmatrix.rotate(new CoffeeGL.Vec3(0, 1, 0), CoffeeGL.degToRad(-90 - deferentAngle));
      fmatrix.translate(new CoffeeGL.Vec3(v1.x, 0, v1.y));
      fmatrix.rotate(new CoffeeGL.Vec3(0, 1, 0), CoffeeGL.degToRad(current_state.rot_interp.set(dt)));
      this.epicycle.matrix.copyFrom(fmatrix.mult(tmatrix));
      cp = this.system.state.epicyclePosition;
      this.marker.matrix.identity();
      this.marker.matrix.translate(new CoffeeGL.Vec3(cp.x, 0.0, cp.y));
      return this;
    };

    EquatorieInteract.prototype._stateRotateMeanAux = function(dt) {
      var current_state;
      current_state = this.stack[this.stack_idx];
      if (current_state.rot_interp == null) {
        current_state.rot_interp = new CoffeeGL.Interpolation(0, this.system.state.meanAux);
      }
      this.pointer.matrix.identity();
      this.pointer.matrix.rotate(new CoffeeGL.Vec3(0, 1, 0), CoffeeGL.degToRad(current_state.rot_interp.set(dt)));
      return this;
    };

    EquatorieInteract.prototype._stateRotateLabel = function(dt) {
      var cp, current_state;
      current_state = this.stack[this.stack_idx];
      if (current_state.rot_interp == null) {
        current_state.rot_interp = new CoffeeGL.Interpolation(0, this.system.state.pointerAngle);
      }
      this.pointer.matrix.identity();
      this.pointer.matrix.rotate(new CoffeeGL.Vec3(0, 1, 0), CoffeeGL.degToRad(this.system.state.meanAux + current_state.rot_interp.set(dt)));
      cp = this.system.state.pointerPoint;
      this.marker.matrix.identity();
      this.marker.matrix.translate(new CoffeeGL.Vec3(cp.x, 0.6, cp.y));
      return this;
    };

    EquatorieInteract.prototype._stateMoveBlackStringFinal = function(dt) {
      var current_state, mv;
      current_state = this.stack[this.stack_idx];
      if (current_state.end_interp == null) {
        mv = new CoffeeGL.Vec3(this.system.state.pointerPoint.x, 0, this.system.state.pointerPoint.y);
        mv.normalize();
        mv.multScalar(10.0);
        mv.y = this.string_height;
        current_state.end_interp = new CoffeeGL.Interpolation(this.black_end.matrix.getPos(), mv);
      }
      this.black_end.matrix.setPos(current_state.end_interp.set(dt));
      this.physics.postMessage({
        cmd: "black_end_move",
        data: this.black_end.matrix.getPos()
      });
      return this;
    };

    EquatorieInteract.prototype._stateMoveBlackStringLatitude = function(dt) {
      var current_state, e, l, s;
      current_state = this.stack[this.stack_idx];
      if ((current_state.start_interp == null) && (current_state.end_interp == null)) {
        s = new CoffeeGL.Vec3(this.system.state.moonLatitudeLeft.x, 0, this.system.state.moonLatitudeLeft.y);
        e = new CoffeeGL.Vec3(this.system.state.moonLatitudeRight.x, 0, this.system.state.moonLatitudeRight.y);
        l = s.dist(e);
        s.x = s.x - (6 - l / 2);
        e.x = e.x + (6 - l / 2);
        s.y = this.string_height;
        e.y = this.string_height;
        current_state.start_interp = new CoffeeGL.Interpolation(this.black_start.matrix.getPos(), s);
        current_state.end_interp = new CoffeeGL.Interpolation(this.black_end.matrix.getPos(), e);
      }
      this.black_start.matrix.setPos(current_state.start_interp.set(dt));
      this.black_end.matrix.setPos(current_state.end_interp.set(dt));
      this.physics.postMessage({
        cmd: "black_start_move",
        data: this.black_start.matrix.getPos()
      });
      this.physics.postMessage({
        cmd: "black_end_move",
        data: this.black_end.matrix.getPos()
      });
      return this;
    };

    EquatorieInteract.prototype.addStates = function(planet, date) {
      var _this = this;
      this.stack = [];
      this.stack.push(new EquatorieState("Select Date and Planet", function() {
        return (function(planet, date) {
          return _this._stateSetPlanetDate(planet, date);
        })(planet, date);
      }));
      if (planet === 'mars' || planet === 'venus' || planet === 'jupiter' || planet === 'saturn' || planet === 'mercury') {
        this.stack.push(new EquatorieState("Calculate Mean Motus", this._stateCalculateMeanMotus));
        this.stack.push(new EquatorieState("Move Black Thread", this._stateMoveBlackThread));
        this.stack.push(new EquatorieState("Move White Thread", this._stateMoveWhiteThread));
        this.stack.push(new EquatorieState("Move Epicycle", this._stateMoveEpicycle));
        this.stack.push(new EquatorieState("Rotate Epicycle", this._stateRotateEpicycle));
        this.stack.push(new EquatorieState("Rotate to the Mean Aux", this._stateRotateMeanAux));
        this.stack.push(new EquatorieState("Rotate Label", this._stateRotateLabel));
        return this.stack.push(new EquatorieState("Move Black Thread", this._stateMoveBlackStringFinal));
      } else if (planet === 'moon') {
        this.stack.push(new EquatorieState("Calculate Mean Motus for the Moon", this._stateCalculateMeanMotus));
        this.stack.push(new EquatorieState("Move Black Thread", this._stateMoveBlackThread));
        this.stack.push(new EquatorieState("Move Epicycle", this._stateMoveEpicycle));
        this.stack.push(new EquatorieState("Rotate Epicycle", this._stateRotateEpicycle));
        this.stack.push(new EquatorieState("Rotate to the Mean Aux", this._stateRotateMeanAux));
        this.stack.push(new EquatorieState("Rotate Label", this._stateRotateLabel));
        return this.stack.push(new EquatorieState("Move White Thread Moon", this._stateMoveWhiteThreadMoon));
      } else if (planet === "moon_latitude") {
        this.stack.push(new EquatorieState("Calculate Mean Motus", this._stateCalculateMeanMotus));
        return this.stack.push(new EquatorieState("Move to Latitude", this._stateMoveBlackStringLatitude));
      } else if (planet === "sun") {
        this.stack.push(new EquatorieState("Calculate Mean Motus", this._stateCalculateMeanMotus));
        this.stack.push(new EquatorieState("Move Black Thread", this._stateMoveBlackThread));
        this.stack.push(new EquatorieState("Move White Thread Sun", this._stateMoveWhiteThreadSun));
        return this.stack.push(new EquatorieState("Move Black Thread Sun", this._stateMoveBlackThreadSun));
      }
    };

    EquatorieInteract.prototype.reset = function() {
      this.stack = [];
      this.stack_idx = 0;
      this.system.reset();
      this.marker.matrix.identity();
      this.epicycle.matrix.identity();
      return this.pointer.matrix.identity();
    };

    EquatorieInteract.prototype.solveForPlanet = function(planet, date) {
      var s, state, _i, _ref, _results;
      this.reset();
      this.addStates(planet, date);
      _results = [];
      for (s = _i = 0, _ref = this.stack.length - 1; 0 <= _ref ? _i <= _ref : _i >= _ref; s = 0 <= _ref ? ++_i : --_i) {
        this.stack_idx = s;
        state = this.stack[s];
        state.activate();
        _results.push(state.update(1.0));
      }
      return _results;
    };

    EquatorieInteract.prototype.onMouseDown = function(event) {
      console.log(event);
      this.mp.x = event.mouseX;
      this.mp.y = event.mouseY;
      this.ray = this.camera.castRay(this.mp.x, this.mp.y);
      this.mdown = true;
      if (!this.picked) {
        return this.camera.onMouseDown(event);
      } else {
        return this.dragging = true;
      }
    };

    EquatorieInteract.prototype.onMouseMove = function(event) {
      var d, dd, np, p0, p1, tp, tray;
      this.mpp.x = this.mp.x;
      this.mpp.y = this.mp.y;
      this.mp.x = event.mouseX;
      this.mp.y = event.mouseY;
      this.mpd.x = this.mp.x - this.mpp.x;
      this.mpd.y = this.mp.y - this.mpp.y;
      if (this.dragging) {
        tray = this.camera.castRay(this.mp.x, this.mp.y);
        d = CoffeeGL.rayPlaneIntersect(new CoffeeGL.Vec3(0, this.string_height, 0), new CoffeeGL.Vec3(0, 1, 0), this.camera.pos, this.ray);
        dd = CoffeeGL.rayPlaneIntersect(new CoffeeGL.Vec3(0, this.string_height, 0), new CoffeeGL.Vec3(0, 1, 0), this.camera.pos, tray);
        p0 = tray.copy();
        p0.multScalar(dd);
        p0.add(this.camera.pos);
        p1 = this.ray.copy();
        p1.multScalar(d);
        p1.add(this.camera.pos);
        p0.y = this.string_height;
        p1.y = this.string_height;
        np = CoffeeGL.Vec3.sub(p0, p1);
        this.ray.copyFrom(tray);
        if (this.picked_item !== this.pointer) {
          tp = this.picked_item.matrix.getPos();
          this.picked_item.matrix.setPos(tp.add(np));
        }
        if (this.picked_item === this.white_start) {
          return this.physics.postMessage({
            cmd: "white_start_move",
            data: this.picked_item.matrix.getPos()
          });
        } else if (this.picked_item === this.white_end) {
          return this.physics.postMessage({
            cmd: "white_end_move",
            data: this.picked_item.matrix.getPos()
          });
        } else if (this.picked_item === this.black_start) {
          return this.physics.postMessage({
            cmd: "black_start_move",
            data: this.picked_item.matrix.getPos()
          });
        } else if (this.picked_item === this.black_end) {
          return this.physics.postMessage({
            cmd: "black_end_move",
            data: this.picked_item.matrix.getPos()
          });
        }
      } else {
        return this.camera.onMouseMove(event);
      }
    };

    EquatorieInteract.prototype.checkPicked = function(p) {
      if (this.dragging) {
        return;
      }
      this.picked = false;
      if (p[0] === 255 && p[1] === 0 && p[2] === 0) {
        this.picked_item = this.white_start;
        return this.picked = true;
      } else if (p[0] === 0 && p[1] === 255 && p[2] === 0) {
        this.picked_item = this.white_end;
        return this.picked = true;
      } else if (p[0] === 0 && p[1] === 0 && p[2] === 255) {
        this.picked_item = this.black_start;
        return this.picked = true;
      } else if (p[0] === 255 && p[1] === 255 && p[2] === 255) {
        this.picked_item = this.black_end;
        return this.picked = true;
      } else if (p[0] === 255 && p[1] === 255 && p[2] === 0) {
        this.picked_item = this.epicycle;
        return this.picked = true;
      } else if (p[0] === 0 && p[1] === 255 && p[2] === 255) {
        this.picked_item = this.pointer;
        return this.picked = true;
      }
    };

    EquatorieInteract.prototype._initGUI = function() {
      var controller, planets,
        _this = this;
      this.datgui = new dat.GUI();
      this.datgui.remember(this);
      planets = ["mars", "venus", "jupiter", "saturn", "mercury", "moon", "sun", "moon_latitude"];
      this.chosen_planet = "mars";
      controller = this.datgui.add(this, 'chosen_planet', planets);
      controller = this.datgui.add(this, 'solveForCurrentDatePlanet');
      controller = this.datgui.add(this, 'advance_date', 0, 730);
      controller.onChange(function(value) {
        return _this.solveForCurrentDatePlanet();
      });
      controller = this.datgui.add(this, "stepForward");
      controller = this.datgui.add(this, "reset");
      controller = this.datgui.add(this.pointer, 'uAlphaX', 0, 1);
      controller = this.datgui.add(this.pointer, 'uAlphaY', 0, 1);
      controller = this.datgui.add(this.epicycle, 'uAlphaX', 0, 1);
      return controller = this.datgui.add(this.epicycle, 'uAlphaY', 0, 1);
    };

    EquatorieInteract.prototype.solveForCurrentDatePlanet = function() {
      var date;
      date = new Date();
      date.setDate(date.getDate() + this.advance_date);
      return this.solveForPlanet(this.chosen_planet, date);
    };

    EquatorieInteract.prototype.stepForward = function() {
      this.time.start = new Date().getTime();
      if (this.stack.length === 0) {
        this.addStates(this.chosen_planet, new Date());
        this.stack_idx = 0;
      } else {
        if (this.stack_idx + 1 < this.stack.length) {
          this.stack[this.stack_idx].update(1.0);
          this.time.dt = 0;
          this.stack_idx += 1;
        }
      }
      return this.stack[this.stack_idx].activate();
    };

    EquatorieInteract.prototype.onMouseOver = function(event) {
      this.mp.x = event.mouseX;
      return this.mp.y = event.mouseY;
    };

    EquatorieInteract.prototype.onMouseUp = function(event) {
      this.mdown = false;
      this.picked = false;
      return this.dragging = false;
    };

    EquatorieInteract.prototype.onMouseOut = function(event) {
      this.mp.x = this.mpp.x = -1;
      this.mp.y = this.mpp.y = -1;
      this.mpd.x = this.mpd.y = 0;
      this.mdown = false;
      this.picked = false;
      return this.dragging = false;
    };

    return EquatorieInteract;

  })();

  module.exports = {
    EquatorieInteract: EquatorieInteract
  };

}).call(this);
